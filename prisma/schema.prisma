generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String      @id @default(cuid())
  email     String?     @unique @db.VarChar(255)
  username  String      @unique @db.VarChar(100)
  password  String?     @db.VarChar(255)
  name      String?     @db.VarChar(150)
  matches   Match[]
  userStats UserStats[]
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  isActive  Boolean     @default(true)

  @@index([email])
  @@index([username])
  @@index([createdAt])
  @@map("users")
}

model Match {
  id           String            @id @default(cuid())
  userId       String
  user         User              @relation(fields: [userId], references: [id])
  date         DateTime
  courtType    CourtType
  category     Category
  result       Result
  goalsFor     Int               @default(0)
  goalsAgainst Int               @default(0)
  performance  PerformanceRating
  notes        String?           @db.Text
  placeId      String            @db.VarChar(255)
  placeName    String            @db.VarChar(255)
  address      String?           @db.VarChar(500)
  city         String?           @db.VarChar(100)
  country      String?           @db.VarChar(100)
  latitude     Float?
  longitude    Float?
  createdAt    DateTime          @default(now())
  updatedAt    DateTime          @updatedAt

  @@index([userId])
  @@index([date])
  @@index([courtType])
  @@index([category])
  @@index([result])
  @@index([performance])
  @@index([userId, date])
  @@index([createdAt])
  @@map("matches")
}

enum CourtType {
  FIVE   @map("5")
  SEVEN  @map("7")
  ELEVEN @map("11")
  OTHER  @map("other")
}

enum Category {
  FRIENDS    @map("friends")
  FRIENDLY   @map("friendly")
  TOURNAMENT @map("tournament")
}

enum Result {
  WON  @map("won")
  LOST @map("lost")
  TIED @map("tied")
}

enum PerformanceRating {
  VERY_BAD  @map("very_bad")
  BAD       @map("bad")
  NEUTRAL   @map("neutral")
  GOOD      @map("good")
  VERY_GOOD @map("very_good")
}

model UserStats {
  id     String @id @default(cuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id])

  totalMatches      Int @default(0)
  totalWins         Int @default(0)
  totalLosses       Int @default(0)
  totalTies         Int @default(0)
  totalGoalsFor     Int @default(0)
  totalGoalsAgainst Int @default(0)

  fiveMatches   Int @default(0)
  sevenMatches  Int @default(0)
  elevenMatches Int @default(0)
  otherMatches  Int @default(0)

  lastMatchDate DateTime?
  updatedAt     DateTime  @updatedAt

  @@map("user_stats")
}
